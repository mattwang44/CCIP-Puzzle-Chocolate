(function(e){function t(t){for(var r,s,i=t[0],c=t[1],u=t[2],f=0,p=[];f<i.length;f++)s=i[f],o[s]&&p.push(o[s][0]),o[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);l&&l(t);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},o={app:0},a=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),o=n.n(r);o.a},"0c44":function(e,t,n){"use strict";var r=n("3254"),o=n.n(r);o.a},1:function(e,t){},"135b":function(e,t,n){},"16c8":function(e,t,n){},"1df5":function(e,t,n){"use strict";var r=n("6166"),o=n.n(r);o.a},"1f6f":function(e,t,n){"use strict";var r=n("9cf0"),o=n.n(r);o.a},2:function(e,t){},"25d8":function(e,t,n){},3:function(e,t){},3254:function(e,t,n){},4:function(e,t){},"490c":function(e,t,n){"use strict";var r=n("135b"),o=n.n(r);o.a},"49f8":function(e,t,n){var r={"./en.json":"edd4","./zh-TW.json":"9ea5"};function o(e){var t=a(e);return n(t)}function a(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id="49f8"},"56d7":function(e,t,n){"use strict";n.r(t);n("456d"),n("ac6a"),n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Header"),n("router-view"),n("Footer")],1)},a=[],s=(n("6762"),n("2fdb"),{name:"App",created:function(){var e=(navigator.languages[0]||navigator.language||navigator.browserLanguage).toLowerCase();e.includes("zh")||(this.$i18n.locale="en")}}),i=s,c=(n("034f"),n("490c"),n("2877")),u=Object(c["a"])(i,o,a,!1,null,null,null),l=u.exports,f=n("8c4f"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"stamp"}},[n("h1",{attrs:{role:"title"}},[e._v("攤位蓋章機")]),null!==e.boothToken&&null!==e.slug?[n("div",{attrs:{role:"booth-info"}},[n("h1",{attrs:{role:"booth-displayText"}},[e._v("已登入為")]),n("div",{attrs:{role:"booth-logo"}},[n("img",{attrs:{src:e.boothProfile.imageUrl,alt:""}})]),n("h1",{attrs:{role:"booth-displayText"}},[e._v(e._s(e.boothProfile.displayText[e.$i18n.locale]))])])]:e._e(),n("qrcode-reader",{attrs:{enable:!0,noResult:!0,role:"stampScanner"},on:{success:e.onScanSuccess,error:e.onScanFail}}),n("Snackbar",{attrs:{isActive:e.showSnackbar}},[e._v("\n    "+e._s(e.message)+"\n  ")])],2)},h=[],d=(n("8e6e"),n("96cf"),n("3b8d")),g=n("bd86"),b=n("2f62"),m=n("bc3a"),v=n.n(m),y=n("70de"),_={baseURL:y.API_URL};Object.assign(v.a.defaults,_);var O=v.a,w=n("4328"),S=n.n(w),P={booth:{getSlugByToken:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O.get("/event/puzzle/deliverer",{params:{token:t}});case 2:return n=e.sent,r=n.data.slug,e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),sendReward2Player:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,n){var r,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O.post("/event/puzzle/deliver?token=".concat(t),S.a.stringify({receiver:n}));case 2:return r=e.sent,o=r.data,e.abrupt("return",o);case 5:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()},player:{getUserStamps:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O.get("/event/puzzle",{params:{token:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()}},k=n("5118");function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){Object(g["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j={name:"Stamp",data:function(){return{boothToken:null,slug:null,playerToken:null,showSnackbar:!1,message:""}},computed:T({},Object(b["b"])(["booth"]),{boothProfile:function(){return this.slug&&this.booth(this.slug)||null}}),watch:{boothToken:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t===n){e.next=4;break}return e.next=3,P.booth.getSlugByToken(this.boothToken);case 3:this.slug=e.sent;case 4:case"end":return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}(),playerToken:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t,n){var r,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(null!==t){e.next=2;break}return e.abrupt("return");case 2:return this.message="Processing",this.toggleSnackbar(),e.prev=4,e.next=7,P.booth.sendReward2Player(this.boothToken,this.playerToken);case 7:return e.next=9,P.get("landing?token=".concat(this.playerToken));case 9:r=e.sent,o=r.data,this.message=this.$t("sendRewardSuccess",{playerName:o,gameReward:this.$t("_stamp")}),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](4),a=e.t0.response.data.message,this.message=this.$t(a);case 18:this.toggleSnackbar();case 19:case"end":return e.stop()}},e,this,[[4,14]])}));function t(t,n){return e.apply(this,arguments)}return t}()},created:function(){this.$store.dispatch("fetchGameConfig")},mounted:function(){this.boothToken=this.$route.query.token||null},methods:{onScanSuccess:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:null===this.boothToken||null===this.boothProfile?this.boothToken=t:t!==this.boothToken&&(this.playerToken=t);case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),toggleSnackbar:function(){this.showSnackbar=!0,Object(k["setTimeout"])(function(){this.showSnackbar=!1,this.playerToken=null}.bind(this),5e3)},onScanFail:function(e){this.message=this.$t("qrcode_scan_fail"),this.toggleSnackbar()}}},R=j,A=(n("0c44"),Object(c["a"])(R,p,h,!1,null,null,null)),x=A.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"reward"}},[n("h1",{attrs:{role:"GameName"}},[e._v(e._s(e.$t("reward")))]),e.showScanner?[n("qrcode-reader",{attrs:{enable:e.showScanner,noResult:!0,title:"",subTitle:e.$t("scan_qrcode")},on:{success:e.onScanSuccess,error:e.onScanFail}})]:e._e(),null!==e.playerPubToken?[n("SquareGrid",{attrs:{booths:e.boothList,userStamps:e.stamps,showAnchor:!0}}),e.description(e.$i18n.locale).length>0?n("div",{attrs:{role:"game-description"}},[e._l(e.description(e.$i18n.locale).split("\n"),function(t,r){return[n("p",{key:r},[e._v(e._s(t))])]})],2):e._e(),n("BoothList",{attrs:{booths:e.booths}})]:e._e(),n("Snackbar",{attrs:{isActive:e.showErrorMessage}},[e._v("\n    "+e._s(e.errorMessage)+"\n    "),0===e.stamps.length?[n("button",{attrs:{role:"retry"},on:{click:e.retryScanner}},[e._v("Retry")])]:e._e()],2)],2)},$=[];n("7514"),n("6c7b");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach(function(t){Object(g["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var U={name:"Reward",computed:D({},Object(b["b"])(["description","booths","stamps","playerPubToken","errorMessage","showErrorMessage"]),{showScanner:function(){return null===this.playerPubToken},boothList:function(){var e=this,t=this.booths.map(function(t){return{isBonus:t.isBonus,significant:t.significant,slug:t.slug,displayText:t.displayText[e.$i18n.locale],imageUrl:t.imageUrl,point:t.point}}),n=Math.ceil(Math.sqrt(t.length,2)),r=n-t.length%n||0;return t.concat(Array(r).fill({isBonus:!1,significant:null,slug:null,displayText:null,imageUrl:null,point:0}))},gotPoints:function(){var e=this;return this.booths.filter(function(e){return e.isBonus}).reduce(function(e,t){return e+t.point},0)+this.stamps.reduce(function(t,n){var r=e.booths.find(function(e){return e.slug===n.deliverer&&!1===e.isBonus});return r&&r.point?t+r.point:t},0)}}),created:function(){this.$store.dispatch("fetchGameConfig");var e=this.$route.query.token||null;null!==e&&(this.$store.dispatch("setPubToken",e),this.$store.dispatch("fetchPuzzleBook"))},methods:{onScanSuccess:function(e){this.$store.dispatch("setPubTokenFromToken",e),this.$store.dispatch("fetchPuzzleBook")},toggleSnackbar:function(){this.$store.dispatch("showErrorMessage")},onScanFail:function(e){this.$store.dispatch("setErrorMessage",this.$t("qrcode_scan_fail")),this.toggleSnackbar()},retryScanner:function(){this.$store.dispatch("setPubToken",null),this.toggleSnackbar()}}},z=U,G=(n("f223"),Object(c["a"])(z,M,$,!1,null,null,null)),N=G.exports,q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"bingo"}},[n("h1",{attrs:{role:"GameName"}},[e._v(e._s(e.$t("bingo")))]),e.playerPubToken?n("h2",{attrs:{role:"bingos"}},[e._v(e._s(e.$t("has_bingos",{bingos:e.bingos.toString()})))]):e._e(),e.showScanner?[n("qrcode-reader",{attrs:{enable:e.showScanner,noResult:!0,title:"",subTitle:e.$t("scan_qrcode")},on:{success:e.onScanSuccess,error:e.onScanFail}})]:e._e(),null!==e.playerPubToken&&e.isConfigurationCorrect?[n("SquareGrid",{attrs:{booths:e.boothList,userStamps:e.stamps,showAnchor:!0}}),e.description(e.$i18n.locale).length>0?n("div",{attrs:{role:"game-description"}},[e._l(e.description(e.$i18n.locale).split("\n"),function(t,r){return[n("p",{key:r},[e._v(e._s(t))])]})],2):e._e(),n("BoothList",{attrs:{booths:e.booths}})]:e._e(),e.isConfigurationCorrect?e._e():[n("div",{attrs:{role:"bingoPatternWrong"}},[n("p",[e._v(e._s(e.$t("Game configuration is not correct")))])])],n("Snackbar",{attrs:{isActive:e.showErrorMessage}},[e._v("\n    "+e._s(e.errorMessage)+"\n    "),0===e.stamps.length?[n("button",{attrs:{role:"retry"},on:{click:e.retryScanner}},[e._v("Retry")])]:e._e()],2)],2)},B=[],L=(n("20d6"),n("28a5"),n("2ef0")),F=n.n(L),I=n("1c46"),H=n.n(I);function W(e){var t=H.a.createHash("md5");return t.update(e),t.digest("hex")}function Q(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=e.toLowerCase().split("").filter(function(e,t,n){return n.indexOf(e)===t}).slice(0,16);while(n.length<16)n.push(t.find(function(e){return!n.includes(e)}));return n.map(function(e){return e.charCodeAt(0)>96?e.charCodeAt(0)-87:e.charCodeAt(0)-48})}function K(e){return function(t,n){var r=Q(W(t)),o=n.reduce(function(e,t){return e[t.significant]instanceof Array?e[t.significant].push(t):e[t.significant]=[t],e},{}),a=Object.keys(o).reduce(function(e,t){var n=r.filter(function(e){return e<o[t].length});return e[t]=o[t].map(function(e,t,r){return r[n[t]]}),e},{});return e.split("").map(function(e){return"0"===e?{isBonus:!0}:a[e].pop()})}}function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach(function(t){Object(g["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Z={name:"Bingo",computed:Y({},Object(b["b"])(["description","booths","bingoPattern","stamps","playerPubToken","errorMessage","showErrorMessage"]),{isConfigurationCorrect:function(){var e=this,t=this.bingoPattern.split("").reduce(function(e,t){var n=e.find(function(e){return e.pattern===t});return n?n.count+=1:e.push({pattern:t,count:1}),e},[]).map(function(t){return Object.assign(t,{matched:e.booths.filter(function(e){return e.significant===t.pattern}).length})}),n=!1,r=!1;return t.forEach(function(e){"0"!==e.pattern&&(n=e.count>e.matched&&n,r=e.count<e.matched&&r)}),r&&console.warn("Some booth will missing on bingo table for some player, see situation 3, case 2, issue #2. https://github.com/CCIP-App/CCIP-Puzzle-Chocolate/issues/2"),this.bingoPattern.length>0&&!0===this.isSquareNumber(this.bingoPattern.length)&&!1===n},showScanner:function(){return null===this.playerPubToken&&this.isConfigurationCorrect},boothList:function(){var e=this;if(!1===this.isConfigurationCorrect)return[];var t=K(this.bingoPattern)(this.playerPubToken||"",this.booths.map(function(t){return{isBonus:t.isBonus,significant:t.significant,slug:t.slug,displayText:t.displayText[e.$i18n.locale],imageUrl:t.imageUrl,point:t.point}}));return t},bingos:function(){var e=this,t=this.boothList.length,n=Math.ceil(Math.sqrt(this.boothList.length,2)),r=[],o=F.a.chunk(Array(t).fill(0).map(function(e,t){return t}),n);r=r.concat(o);var a=Array(n).fill(Array(n).fill(0)).map(function(e,t){return e.map(function(e,r){return r*n+t})});r=r.concat(a);var s=Array(n).fill(0).map(function(e,t){return t+t*n}),i=Array(n).fill(0).map(function(e,t){return(t+1)*(n-1)});r=r.concat([s],[i]);var c=r.map(function(t){return t.map(function(t){return{slug:e.boothList[t].slug,isBonus:e.boothList[t].isBonus}})}),u=this.stamps.map(function(e){return e.deliverer});return c.filter(function(e){return e.reduce(function(e,t){return(u.findIndex(function(e){return e===t.slug})>-1||t.isBonus)&&e},!0)}).length}}),created:function(){this.$store.dispatch("fetchGameConfig");var e=this.$route.query.token||null;null!==e&&(this.$store.dispatch("setPubToken",e),this.$store.dispatch("fetchPuzzleBook"))},methods:{isSquareNumber:function(e){return e%Math.sqrt(e,2)===0},onScanSuccess:function(e){this.$store.dispatch("setPubTokenFromToken",e),this.$store.dispatch("fetchPuzzleBook")},onScanFail:function(e){this.$store.dispatch("setErrorMessage",this.$t("qrcode_scan_fail")),this.toggleSnackbar()},toggleSnackbar:function(){this.$store.dispatch("showErrorMessage")},retryScanner:function(){this.$store.dispatch("setPubToken",null),this.toggleSnackbar()}}},V=Z,X=(n("b16c"),Object(c["a"])(V,q,B,!1,null,null,null)),ee=X.exports,te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},ne=[],re={},oe=re,ae=Object(c["a"])(oe,te,ne,!1,null,null,null),se=ae.exports;r["a"].use(f["a"]);var ie=new f["a"]({mode:"history",routes:[{path:"/",component:"bingo"===y["defaultMode"]?ee:N},{path:"/stamp",component:x},{path:"/reward",component:N},{path:"/bingo",component:ee},{path:"/fragment",component:se}]}),ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"boothList"}},[e._l(e.booths,function(t,r){return[n("div",{key:r,attrs:{role:"booth",id:t.slug}},[n("div",{attrs:{role:"logo"}},[n("img",{attrs:{src:t.imageUrl}})]),n("div",{attrs:{role:"description"}},[n("h1",[e._v(e._s(t.displayText[e.$i18n.locale]))]),n("p",[e._v(e._s(t.description[e.$i18n.locale]))])])])]})],2)},ue=[],le={name:"BoothList",props:{booths:{type:Array,default:function(){return[]}}}},fe=le,pe=(n("bc33"),Object(c["a"])(fe,ce,ue,!1,null,null,null)),he=pe.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{active:e.isActive},attrs:{role:"chip"}},[n("img",{attrs:{role:"logo",src:e.logourl,alt:e.displayName}}),e._m(0)])},ge=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{role:"stampImg"}},[r("img",{attrs:{src:n("7c96")}})])}],be={name:"Chip",props:{displayName:{type:String,default:""},logoUri:{type:String,default:""},isActive:{type:Boolean,default:!1}},computed:{logourl:function(){return this.logoUri}}},me=be,ve=(n("a0c0"),Object(c["a"])(me,de,ge,!1,null,null,null)),ye=ve.exports,_e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"Footer"}},[n("div",{staticClass:"content"},[e._v("\n    "+e._s(e.confName)+" × OPass | Fork on\n    "),n("a",{attrs:{href:"https://github.com/CCIP-App/CCIP-Puzzle-Chocolate/",target:"_blank",alt:"Source code on GitHub"}},[e._v("GitHub")])])])},Oe=[];function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(n,!0).forEach(function(t){Object(g["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Pe={name:"Footer",computed:Se({},Object(b["b"])(["confName"]))},ke=Pe,Ee=(n("ee86"),Object(c["a"])(ke,_e,Oe,!1,null,null,null)),Te=Ee.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"fragments"}},[e._l(e.fragments,function(t,r){return[n("div",{key:r,attrs:{role:"puzzle"}},[n("div",{attrs:{role:"puzzle-name"}},[n("span",[e._v(e._s(t.puzzle))])]),n("div",{attrs:{role:"puzzle-count"}},[n("span",[e._v(e._s(t.count))])])])]})],2)},Re=[],Ae={name:"FragmentList",props:{fragments:{type:Array,default:function(){return[]}}}},xe=Ae,Me=(n("d155"),Object(c["a"])(xe,je,Re,!1,null,null,null)),$e=Me.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{role:"header"}},[e._v("\n  "+e._s(e.confName)+" × OPass\n")])},De=[];function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(n,!0).forEach(function(t){Object(g["a"])(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ge={name:"Header",computed:ze({},Object(b["b"])(["confName"]))},Ne=Ge,qe=(n("6c3e"),Object(c["a"])(Ne,Ce,De,!1,null,null,null)),Be=qe.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"QrcodeReader"}},[n("center",[""!=e.title?n("h2",{staticClass:"ma-0"},[e._v(e._s(e.title))]):e._e(),e.webrtc?n("div",{attrs:{id:"camsource"}}):n("div",{attrs:{id:"uploadField"}},[n("label",{attrs:{id:"uploadButton",for:"upload"}}),n("input",{attrs:{type:"file",id:"upload"},on:{change:e.uploadChange}})]),""!==e.subTitle?n("p",{attrs:{role:"subTitle"}},[e._v(e._s(e.subTitle))]):e._e(),e.noResult?e._e():n("h6",{staticClass:"ma-0"},[e._v(e._s(e.result))])])],1)},Fe=[],Ie=(n("4917"),{name:"QrcodeReader",props:{title:{type:String,default:""},subTitle:{type:String,default:""},enable:Boolean,noResult:Boolean,width:{type:String,default:"320px"},height:{type:String,default:"240px"}},data:function(){return{result:"Loading...",cam:null,webrtc:!0,scanner:null}},watch:{enable:function(e){var t=this;t.scanner.setStopped(!e)},result:function(e){null!==e&&this.emitResult(this,e)}},mounted:function(){var e=this;window.w69b.qr.decoding.setWorkerUrl("".concat("/","barcode.js/w69b.qrcode.decodeworker.min.js")),navigator.mediaDevices&&!window.navigator.userAgent.match(/iPhone|iPad|iPod/i)?(e.webrtc=!0,e.scanner=new window.w69b.qr.ui.ContinuousScanner,e.scanner.setDecodedCallback(function(t){e.onSuccess(t)}),e.scanner.render(document.getElementById("camsource"))):(e.webrtc=!1,console.log("Sorry, native web camera streaming (getUserMedia) is not supported by this browser..."))},beforeDestroy:function(){if(navigator.mediaDevices){var e=this;e.scanner.setStopped(!0),e.scanner.dispose()}},methods:{onSuccess:function(e){this.result=e},emitResult:F.a.debounce(function(e,t){e.result=null,e.$emit("success",t)},500),uploadChange:function(){var e=this,t=document.getElementById("upload").files[0],n=/^image\//;n.test(t.type)||console.log("File type not valid");var r=new FileReader;r.addEventListener("load",function(){var t=new Image;t.onload=function(n){var r=new window.w69b.qr.decoding.Decoder;r.decode(t).then(function(t){e.onSuccess(t.text)},function(){e.$emit("error","no qr code found")})},t.src=this.result}.bind(r),!1),r.readAsDataURL(t)}}}),He=Ie,We=(n("1df5"),Object(c["a"])(He,Le,Fe,!1,null,null,null)),Qe=We.exports,Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:"--edgeLength: "+e.edgeLength,attrs:{role:"squareGrid"}},[e._l(e.booths,function(t,r){return[e.showAnchor&&t.slug?[n("a",{key:r,attrs:{href:"#"+t.slug}},[n("Chip",{attrs:{logoUri:t.imageUrl,displayName:t.displayText,isActive:e.userStamps.findIndex(function(e){return e.deliverer===t.slug})>-1||t.isBonus}})],1)]:[n("Chip",{key:r,attrs:{logoUri:t.imageUrl,displayName:t.displayText,isActive:e.userStamps.findIndex(function(e){return e.deliverer===t.slug})>-1||t.isBonus}})]]})],2)},Je=[],Ye={name:"SquareGrid",props:{booths:{type:Array,default:function(){return[]}},userStamps:{type:Array,default:function(){return[]}},showAnchor:{type:Boolean,default:!1}},computed:{edgeLength:function(){return Math.ceil(Math.sqrt(this.booths.length,2))}}},Ze=Ye,Ve=(n("1f6f"),Object(c["a"])(Ze,Ke,Je,!1,null,null,null)),Xe=Ve.exports,et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{active:e.isActive},attrs:{role:"snackbar"}},[n("div",{staticClass:"wrapper"},[e._t("default")],2)])},tt=[],nt={name:"Snackbar",props:{isActive:{type:Boolean,default:!1}}},rt=nt,ot=(n("bc79"),Object(c["a"])(rt,et,tt,!1,null,null,null)),at=ot.exports,st={BoothList:he,Chip:ye,Footer:Te,FragmentList:$e,Header:Be,QrcodeReader:Qe,SquareGrid:Xe,Snackbar:at},it=n("a925");function ct(){var e=n("49f8"),t={};return e.keys().forEach(function(n){var r=n.match(/([A-Za-z0-9-_]+)\./i);if(r&&r.length>1){var o=r[1];t[o]=e(n)}}),t}r["a"].use(it["a"]);var ut=new it["a"]({locale:"zh-TW",fallbackLocale:"en",messages:ct()}),lt={confName:"",title:{"zh-TW":"",en:""},description:{"zh-TW":"",en:""},bingoPattern:"",booths:[]},ft={UPDATE_CONFIG:"UPDATE_CONFIG"},pt={confName:function(e){return e.confName},title:function(e){return function(t){return e.title[t]||e.title.en}},description:function(e){return function(t){return e.description[t]||e.description.en}},bingoPattern:function(e){return e.bingoPattern},booths:function(e){return e.booths},booth:function(e){return function(t){return e.booths.find(function(e){return e.slug===t})}}},ht={fetchGameConfig:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!y["configURL"]){e.next=6;break}return e.next=3,v.a.get(y["configURL"]);case 3:n=e.sent,r=n.data,t.commit(ft.UPDATE_CONFIG,r);case 6:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()},dt={UPDATE_CONFIG:function(e,t){e.booths=t.booths,e.confName=t.confName,e.title=t.title||{en:"title undefined"},e.description=t.description||{en:"description undefined"},e.bingoPattern=t.bingoPattern}},gt={state:lt,getters:pt,actions:ht,mutations:dt,types:ft},bt={playerPubToken:null,stamps:[],fragments:[],errorMessage:null,showErrorMessage:!1},mt={SET_TOKEN:"SET_TOKEN",UPDATE_FRAGMENT:"UPDATE_FRAGMENT",UPDATE_STAMPS:"UPDATE_STAMPS",UPDATE_ERROR_MESSAGE:"UPDATE_ERROR_MESSAGE",UPDATE_SHOW_ERROR_MESSAGE:"UPDATE_SHOW_ERROR_MESSAGE"},vt={fragments:function(e){return e.fragments},stamps:function(e){return e.stamps},playerPubToken:function(e){return e.playerPubToken},errorMessage:function(e){return e.errorMessage},showErrorMessage:function(e){return e.showErrorMessage}},yt={setPubTokenFromToken:function(e,t){var n=H.a.createHash("sha1");n.update(t);var r=n.digest("hex");e.commit("SET_TOKEN",r)},setPubToken:function(e,t){e.commit("SET_TOKEN",t)},setErrorMessage:function(e,t){e.commit("UPDATE_ERROR_MESSAGE",t)},fetchPuzzleBook:function(){var e=Object(d["a"])(regeneratorRuntime.mark(function e(t){var n,r,o,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.player.getUserStamps(t.state.playerPubToken);case 3:n=e.sent,r=n.puzzles,o=n.deliverers,t.commit("UPDATE_FRAGMENT",r||[]),t.commit("UPDATE_STAMPS",o||[]),e.next=15;break;case 9:e.prev=9,e.t0=e["catch"](0),a=e.t0.response.data.message,t.commit("UPDATE_ERROR_MESSAGE",a),t.commit("UPDATE_FRAGMENT",[]),t.commit("UPDATE_STAMPS",[]);case 15:case"end":return e.stop()}},e,null,[[0,9]])}));function t(t){return e.apply(this,arguments)}return t}(),showErrorMessage:function(e){e.commit("UPDATE_SHOW_ERROR_MESSAGE",!0)},hideErrorMessage:function(e){e.commit("UPDATE_SHOW_ERROR_MESSAGE",!1)}},_t={SET_TOKEN:function(e,t){e.playerPubToken=t},UPDATE_FRAGMENT:function(e,t){e.fragments=t},UPDATE_STAMPS:function(e,t){e.stamps=t},UPDATE_ERROR_MESSAGE:function(e,t){e.errorMessage=t,e.showErrorMessage=!0},UPDATE_SHOW_ERROR_MESSAGE:function(e){e.showErrorMessage=!e.showErrorMessage}},Ot={state:bt,getters:vt,actions:yt,mutations:_t,types:mt};r["a"].use(b["a"]);var wt=new b["a"].Store({strict:!0,modules:{Config:gt,Puzzle:Ot}});r["a"].config.productionTip=!1,Object.keys(st).forEach(function(e){r["a"].component(e,st[e])}),new r["a"]({router:ie,store:wt,i18n:ut,render:function(e){return e(l)},mounted:function(){return document.dispatchEvent(new Event("x-app-rendered"))}}).$mount("#app")},6166:function(e,t,n){},"64a9":function(e,t,n){},"6c3e":function(e,t,n){"use strict";var r=n("25d8"),o=n.n(r);o.a},"70de":function(e){e.exports={API_URL:"https://pycon.opass.app/",configURL:"https://game.pycon.tw/config.json"}},"795e":function(e,t,n){},"7a20":function(e,t,n){},"7c96":function(e,t,n){e.exports=n.p+"img/OPASS-pass-stamp.adfe341d.png"},"9cf0":function(e,t,n){},"9e4c":function(e,t,n){},"9ea5":function(e){e.exports={has_got_points:"已獲得 {points} 點",scan_qrcode:"請掃描 QR Code",scanner:"QR Code 掃瞄器",reward:"集章冊",bingo:"賓果冊",fragment:"碎片收集冊",sendRewardSuccess:"{gameReward} 已經發送給 {playerName}",_stamp:"戳章",_fragment:"碎片",has_bingos:"已達成 {bingos} 連線","Already take from this deliverer":"已經蓋過章囉(￣▽￣)","invalid receiver token":"條碼好像不正確(⊙ω⊙)","token and receiver required":"好像抓不到條碼(;´༎ຶД༎ຶ`)",qrcode_scan_fail:"無法識別 QR Code，請嘗試調整亮度與拍照角度試試","Game configuration is not correct":"遊戲設定檔異常，無法進行遊戲，請回報給工作人員(´・ω・`)"}},a0c0:function(e,t,n){"use strict";var r=n("bc5d"),o=n.n(r);o.a},b16c:function(e,t,n){"use strict";var r=n("795e"),o=n.n(r);o.a},bc33:function(e,t,n){"use strict";var r=n("7a20"),o=n.n(r);o.a},bc5d:function(e,t,n){},bc79:function(e,t,n){"use strict";var r=n("d6ee"),o=n.n(r);o.a},d089:function(e,t,n){},d155:function(e,t,n){"use strict";var r=n("d089"),o=n.n(r);o.a},d6ee:function(e,t,n){},edd4:function(e){e.exports={has_got_points:"You got {points} points",scan_qrcode:"Scan your QR Code",scanner:"QR Code Scanner",reward:"Reward Card",bingo:"Bingo Card",fragment:"Fragment Card",sendRewardSuccess:"{gameReward} has been sent to {playerName}",_stamp:"Stamp",_fragment:"fragment",has_bingos:"{bingos} bingos","Already take from this deliverer":"Already take from this deliverer","invalid receiver token":"Invalid receiver token","token and receiver required":"Token and receiver required",qrcode_scan_fail:"QRCode not found, please retry after adjust screen brightness of QRCode and photo shooting angle","Game configuration is not correct":"Game configuration is not correct. Please report this problem to staffs."}},ee86:function(e,t,n){"use strict";var r=n("16c8"),o=n.n(r);o.a},f223:function(e,t,n){"use strict";var r=n("9e4c"),o=n.n(r);o.a}});
//# sourceMappingURL=app.0e0c1ef0.js.map